'use strict';angular.module('angular-client-side-auth',['ngCookies','ngRoute','ui.router','ngResource']).config(['$routeProvider','$locationProvider','$httpProvider','$stateProvider','$urlRouterProvider',function($routeProvider,$locationProvider,$httpProvider,$stateProvider,$urlRouterProvider){$httpProvider.defaults.withCredentials=true;var access=routingConfig.accessLevels;$routeProvider.otherwise({redirectTo:'/'});$urlRouterProvider.otherwise('/');$stateProvider.state('welcome',{url:'/',templateUrl:'/views/admin.html',controller:'AdminCtrl',access:access.admin});$stateProvider.state('login',{url:'/login',templateUrl:'/views/login.html',controller:'LoginCtrl',access:access.anon});$stateProvider.state('settings',{parent:'welcome',url:'settings',templateUrl:'/views/settings.html',controller:'SettingsCtrl',access:access.admin});$stateProvider.state('clients',{parent:'welcome',url:'clients',templateUrl:'/views/clients/clients.html',controller:'ClientsCtrl',access:access.admin});$stateProvider.state('exercises',{parent:'welcome',url:'exercises',templateUrl:'/views/exercises/exercises.html',controller:'ExercisesCtrl',access:access.admin});$stateProvider.state('exercises.new',{url:'/new',templateUrl:'/views/exercises/new.html',access:access.admin});$stateProvider.state('exercises.detail',{url:'/:exerciseId',templateUrl:'/views/exercises/detail.html',controller:'ExerciseDetailCtrl',access:access.admin});$stateProvider.state('workouts',{parent:'welcome',url:'workouts',templateUrl:'/views/workouts/workouts.html',controller:'WorkoutsCtrl',access:access.admin});$stateProvider.state('workouts.new',{url:'/new',templateUrl:'/views/workouts/new.html',access:access.admin});$stateProvider.state('workouts.detail',{url:'/:workoutId',templateUrl:'/views/workouts/detail.html',controller:'WorkoutDetailCtrl',access:access.admin});$locationProvider.html5Mode(true);$httpProvider.interceptors.push(function($q,$location){return{'responseError':function(response){if(response.status===401||response.status===403){$location.path('/login');return $q.reject(response);}else{return $q.reject(response);}}}});}]).run(['$rootScope','$location','$http','Auth',function($rootScope,$location,$http,Auth){$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){$rootScope.error=null;if(!Auth.authorize(toState.access)){if(Auth.isLoggedIn())$location.path('/');else $location.path('/login');}});}]);