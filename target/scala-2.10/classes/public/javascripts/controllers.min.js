'use strict';angular.module('angular-client-side-auth').controller('NavCtrl',['$rootScope','$scope','$location','Auth',function($rootScope,$scope,$location,Auth){$scope.user=Auth.user;$scope.userRoles=Auth.userRoles;$scope.accessLevels=Auth.accessLevels;$scope.logout=function(){Auth.logout(function(){$location.path('/login');},function(){$rootScope.error="Failed to logout";});};}]);angular.module('angular-client-side-auth').controller('LoginCtrl',['$rootScope','$scope','$location','$window','Auth',function($rootScope,$scope,$location,$window,Auth){$scope.rememberme=true;$scope.login=function(){Auth.login({email:$scope.email,password:$scope.password,rememberme:$scope.rememberme},function(res){Auth.check(function(valid){if(valid)$location.path('/');else$rootScope.error="Failed to login";})},function(err){$rootScope.error="Failed to login";});};$scope.loginOauth=function(provider){$window.location.href='/auth/'+provider;};}]);angular.module('angular-client-side-auth').controller('RegisterCtrl',['$rootScope','$scope','$location','Auth',function($rootScope,$scope,$location,Auth){$scope.role=Auth.userRoles.user;$scope.userRoles=Auth.userRoles;$scope.register=function(){Auth.register({username:$scope.username,password:$scope.password,role:$scope.role},function(){$location.path('/');},function(err){$rootScope.error=err;});};}]);angular.module('angular-client-side-auth').controller('SettingsCtrl',['$rootScope','$scope','Auth',function($rootScope,$scope,Auth){}]);angular.module('angular-client-side-auth').controller('ExercisesCtrl',['$scope','$state','Exercises','Trainers','Auth',function($scope,$state,Exercises,Trainers,Auth){$scope.exercises=Trainers.query({tid:Auth.user._id,entity:'exercises'});$scope.exercise=new Exercises();$scope.newExercise=function(){$scope.exercise.$save(function(exercise,res){$state.go('exercises.detail',{exerciseId:exercise._id},{reload:true});});};$scope.cancel=function(){$state.go('exercises',{},{reload:true});};$scope.removeExercise=function(eid){$scope.exercise.$delete({eid:eid},function(res){$state.go('exercises',{},{reload:true});});};}]);angular.module('angular-client-side-auth').controller('ExerciseDetailCtrl',['$rootScope','$scope','$location','$window','$stateParams','Exercises',function($rootScope,$scope,$location,$window,$stateParams,Exercises){$scope.exercise=Exercises.get({eid:$stateParams.exerciseId});$scope.updateExercise=function(){$scope.exercise.$save({eid:$scope.exercise._id});};}]);angular.module('angular-client-side-auth').controller('WorkoutsCtrl',['$scope','$state','Trainers','Workouts','Auth',function($scope,$state,Trainers,Workouts,Auth){$scope.levels=[1,2,3,4,5,6,7,8,9,10];$scope.workouts=Trainers.query({tid:Auth.user._id,entity:'workouts'});$scope.workout=new Workouts();$scope.newWorkout=function(){$scope.workout.$save(function(workout,res){$state.go('workouts.detail',{workoutId:workout._id},{reload:true});});};$scope.cancel=function(){$state.go('workouts',{},{reload:true});};$scope.removeWorkout=function(wid){Workouts.$delete({wid:wid},function(res){$state.go('workouts',{},{reload:true});});};}]);angular.module('angular-client-side-auth').controller('WorkoutDetailCtrl',['$rootScope','$scope','$location','$window','$stateParams','Workouts',function($rootScope,$scope,$location,$window,$stateParams,Workouts){$scope.workout=Workouts.get({wid:$stateParams.workoutId});$scope.updateWorkout=function(){$scope.workout.$save({wid:$scope.workout._id});};}]);angular.module('angular-client-side-auth').controller('AdminCtrl',['$rootScope','$scope','Auth',function($rootScope,$scope,Auth){}]);angular.module('angular-client-side-auth').controller('ClientsCtrl',['$rootScope','$scope','Trainers','Auth',function($rootScope,$scope,Trainers,Auth){$scope.clients=Trainers.query({tid:Auth.user._id,entity:'clients'});}]);